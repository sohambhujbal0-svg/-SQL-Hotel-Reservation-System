CREATE DATABASE HOTELS;USE HOTELS;  
USE HOTELS;  

CREATE TABLE HOTELS (  
HOTEL_ID INT PRIMARY KEY,  
HOTEL_NAME VARCHAR(100),  
LOCATION VARCHAR(100),  
RATING DECIMAL(2,1));
    
INSERT INTO HOTELS VALUES
(1,'TAJ HOTEL','MUMBAI',4.5),  
(2,'VEDANGI','ANDHERI',4.2),  
(3,'SAI SHANKAR','MALAD',4.7),  
(4,'SAI DARBAR','VADALA',4.6),  
(5,'NIKHIL','DADAR',4.1),  
(6,'SHOURYWADA','BANDRA',4.8),  
(7,'AARADHYA','KURLA',4.5);  
  
SELECT * FROM HOTELS;

CREATE TABLE ROOMS(  
ROOM_ID INT PRIMARY KEY,  
HOTEL_ID INT,  
ROOM_NUMBER INT,  
ROOM_TYPE VARCHAR(50),  
PRICE_PER_NIGHT DECIMAL(10,2),  
AVAILABILITY VARCHAR(10),  
FOREIGN KEY (HOTEL_ID) REFERENCES HOTELS(HOTEL_ID));  
    
INSERT INTO ROOMS VALUES  
(101,1,1001,'SINGLE',1000.00,'YES'),  
(102,2,1002,'SUITE',3000.00,'NO'),  
(103,3,1003,'DOUBLE',1500.00,'YES'), 
(104,4,1004,'SINGLE',1000.00,'YES'),  
(105,5,1005,'SUITE',3000.00,'NO'),  
(106,6,1006,'DOUBLE',1500.00,'YES'),  
(107,7,1007,'SINGLE',1000.00,'NO');  
         
SELECT * FROM ROOMS;

CREATE TABLE CUSTOMERS(  
CUSTOMER_ID INT PRIMARY KEY,  
FULL_NAME VARCHAR(50),  
EMAIL VARCHAR(100) UNIQUE,  
PHONE VARCHAR(15),  
ADDRESS VARCHAR(255));

INSERT INTO CUSTOMERS VALUES  
(201,'SAKSHI DONGARE','SAKSHI@GMAIL.COM','9402829493','SAI MANDIR ANDHERI EAST'),      
(202,'OMKAR PARAB','OMKAR@GMAIL.COM','9502842492','LINK ROAD GOREGAON WEST'),  
(203,'TUSHAR ANBHAVANE','TUSHAR@GMAIL.COM','9002129488','SHIVAJI CHOUK DADAR WEST'),     
(204,'SOHAM TANAVADE','SOHAM@GMAIL.COM','9402832125','RAM MANDIR ANDHERI EAST'),  
(205,'OM MAPHSEKAR','OM@GMAIL.COM','9826836171','GANESH CHOUK BORIVALI WEST'),  
(206,'SHAMIKA SINGH','SHAMIKA@GMAIL.COM','9402827575','SAI MANDIR BANDRA WEST');

INSERT INTO CUSTOMERS VALUES 
(207,'SAHIL JADHAV','SAHILJADHAV@GMAIL.COM','8543542342','VIRVANI GOREGAON EAST');  

SELECT * FROM CUSTOMERS; 

CREATE TABLE RESERVATION(  
RESERVATION_ID INT PRIMARY KEY,  
CUSTOMER_ID INT,  
ROOM_ID INT,  
CHECK_IN_DATE DATE,  
CHECK_OUT_DATE DATE,  
STATUS VARCHAR(20),  
FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMERS(CUSTOMER_ID),  
FOREIGN KEY (ROOM_ID) REFERENCES ROOMS(ROOM_ID)); 

INSERT INTO RESERVATION VALUES  
(301,201,101,'2025-06-02','2025-06-03','CHACKED OUT'),  
(302,202,102,'2025-08-08','2025-08-10','BOOKED'),     
(303,203,103,'2025-08-18','2025-08-19','CANCELLED'),  
(304,204,104,'2025-08-24','2025-08-26','CHECKED IN'),  
(305,205,105,'2025-08-25','2025-09-03','BOOKED'),  
(306,206,106,'2025-09-05','2025-09-08','CANCELLED');

SELECT * FROM RESERVATION; 

CREATE TABLE PAYMENTS(  
PAYMENT_ID INT PRIMARY KEY,  
RESERVATION_ID INT,  
AMOUNT DECIMAL(10,2),  
PAYMENT_DATE DATE,  
PAYMENT_METHOD VARCHAR(20),  
FOREIGN KEY (RESERVATION_ID) REFERENCES RESERVATION(RESERVATION_ID));  
      
INSERT INTO PAYMENTS VALUES  
(401,301,2000.00,'2025-06-02','CARD'),  
(402,302,3000.00,'2025-08-08','ONLINE'),  
(403,303,2500.00,'2025-08-18','CASH'),  
(404,304,2000.00,'2025-08-24','CARD'),  
(405,305,2000.00,'2025-08-25','ONLINE'),  
(406,306,3000.00,'2025-09-05','ONLINE');  
SELECT * FROM PAYMENTS;  

CREATE TABLE STAFF(  
STAFF_ID INT PRIMARY KEY,  
FULL_NAME VARCHAR(50),  
ROLE VARCHAR(50),  
HOTEL_ID INT,  
FOREIGN KEY (HOTEL_ID) REFERENCES HOTELS(HOTEL_ID));  
      
INSERT INTO STAFF VALUES  
(501,'HARSHIT RANA', 'MANAGER',1),  
(502,'MITALI SINGH', 'RECEPTIONIST',2),  
(503,'NAMRTA YADAV', 'HOUSEKEEPING',3),  
(504,'SHIVA RAMA', 'HOUSEKEEPING',4),  
(505,'SURAJ RAI', 'WORKER',5),  
(506,'RAMRAJU SINHA', 'CLEANER',6);  

SELECT * FROM STAFF;  

  
-- Q.1 GET HOTEL NAME AND ROOM NUMBER OF ALL AVAILABLE ROOMS.  
    SELECT H.HOTEL_NAME, R.ROOM_NUMBER,ROOM_TYPE, R.AVAILABILITY FROM ROOMS R      LEFT JOIN HOTELS H  
    ON R.HOTEL_ID = H.HOTEL_ID     
WHERE R.AVAILABILITY ='YES'; 

-- Q.2 LIST ALL ROOMS IN SAI DARBAR HOTEL.  
    SELECT R.ROOM_ID, H.HOTEL_NAME, R.ROOM_NUMBER, R.ROOM_TYPE, R.PRICE_PER_NIGHT     
FROM ROOMS R   
    RIGHT JOIN HOTELS H  
    ON R.HOTEL_ID = H.HOTEL_ID     WHERE HOTEL_NAME = 'SAI DARBAR';
    
-- Q.3 FIND AVAILABLE ROOMS IN HOTELS  
    SELECT * FROM ROOMS     WHERE 
    AVAILABILITY = 'YES'; 
    
-- Q.4 Show customers who never made a reservation.  
    SELECT C.CUSTOMER_ID, C.FULL_NAME FROM CUSTOMERS C  
    LEFT JOIN RESERVATION R  
    ON C.CUSTOMER_ID = R.CUSTOMER_ID  
    WHERE R.RESERVATION_ID IS NULL;
    
-- Q.5 FIND THE PHONE NUMBER OF THE CUSTOMER OMKAR PARAB.  
    SELECT FULL_NAME, PHONE FROM CUSTOMERS  
    WHERE CUSTOMER_ID = 202; 
    
-- Q.6 LIST STAFF WORKING IN EACH HOTEL.   
  	SELECT H.HOTEL_NAME, S.FULL_NAME, S.ROLE  
  	FROM STAFF S   
  	JOIN HOTELS H   
  	ON S.HOTEL_ID = H.HOTEL_ID;  
    
-- Q.7 LIST ALL ROOMS IN HOTELS SHOURYWADA.  
 SELECT R.ROOM_ID,R.ROOM_NUMBER, R.ROOM_TYPE,R.PRICE_PER_NIGHT,R.AVAILABILITY  
FROM ROOMS R   
  	JOIN HOTELS H  
  	ON R.HOTEL_ID = H.HOTEL_ID   WHERE 
H.HOTEL_NAME = 'SHOURYWADA';  

-- Q.8 COUNT HOW MENY ROOMS A HOTEL NIKHIL.  
    SELECT H.HOTEL_NAME ,COUNT(R.ROOM_ID) AS TOTAL_ROOM FROM HOTELS H  
    LEFT JOIN ROOMS R   
  	ON H.HOTEL_ID = R.ROOM_ID  
  	WHERE H.HOTEL_ID = '5';  
    
-- Q.9 SHOW ALL CUSTOMERS WHO 'BOOKED'A SUITE.  
  	SELECT C.FULL_NAME, RO.ROOM_TYPE, R.STATUS FROM ROOMS RO   
  	JOIN RESERVATION R   
  	ON R.ROOM_ID = RO.ROOM_ID  
  	JOIN CUSTOMERS C   
  	ON R.CUSTOMER_ID = C.CUSTOMER_ID  
  	WHERE R.STATUS = 'BOOKED';  
    
-- Q.10 FIND THE STAFF ROLE 'MANAGER' IN EACH HOTEL.  
    SELECT S.FULL_NAME, S.ROLE, H.HOTEL_NAME FROM STAFF S  
    LEFT JOIN HOTELS H   
    ON S.HOTEL_ID = H.HOTEL_ID  
    WHERE S.ROLE = 'MANAGER'; 
    
-- Q.11 SHOW ALL RESERVATIONS FOR 'TUSHAR ANBHAVANE' .  
 SELECT R.RESERVATION_ID, C.FULL_NAME, RO.ROOM_NUMBER, RO.ROOM_TYPE,R.STATUS FROM RESERVATION R   
  	JOIN CUSTOMERS C   
  	ON R.CUSTOMER_ID = C.CUSTOMER_ID  
  	JOIN ROOMS RO   
  	ON R.ROOM_ID = RO.ROOM_ID  
  	WHERE C.CUSTOMER_ID =203;  
    
-- Q.12 GET ALL RESERVATIONS WHERE CHECK_OUT_DATE AFTER 2025-08-08.  
 SELECT R.RESERVATION_ID,R.CUSTOMER_ID, C.FULL_NAME,R.CHECK_OUT_DATE FROM RESERVATION R   
  	RIGHT JOIN CUSTOMERS C   
  	ON R.CUSTOMER_ID = C.CUSTOMER_ID  
  	WHERE R.CHECK_OUT_DATE >'2025-08-10';  
    
-- Q.13 FIND ROOMS THAT COST MORE THAN 1500.00 PER NIGHT.  
  	SELECT ROOM_ID, ROOM_NUMBER, ROOM_TYPE, PRICE_PER_NIGHT FROM ROOMS   
  	WHERE PRICE_PER_NIGHT > 1500.00;  
    
-- Q.14 SHOW LIST USING ONLY ONLINE PAYMENT METHOD.  
 SELECT P.PAYMENT_ID, P.AMOUNT, P.PAYMENT_DATE, P.PAYMENT_METHOD, C.FULL_NAME FROM PAYMENTS P   
  	JOIN RESERVATION R   
  	ON P.RESERVATION_ID = R.RESERVATION_ID  
  	JOIN CUSTOMERS C   
  	ON R.CUSTOMER_ID = C.CUSTOMER_ID  
 WHERE P.PAYMENT_METHOD ='ONLINE'; 
 
 -- Q.15 GET HOTEL NAME AND ROOM NUMBERS OF ALL AVAILABLE ROOMS.  
  	SELECT H.HOTEL_NAME, R.ROOM_NUMBER, R.AVAILABILITY FROM HOTELS H   
  	LEFT JOIN ROOMS R  
  	ON H.HOTEL_ID = R.HOTEL_ID  
  	WHERE AVAILABILITY = 
'YES'; 

-- Q.16 FIND CUSTOMERS WITH THEIR RESERVATION 'TAJ HOTEL'.   
 SELECT H.HOTEL_NAME,R.CUSTOMER_ID, C.FULL_NAME, R.ROOM_ID, R.STATUS FROM RESERVATION R   
  	JOIN CUSTOMERS C   
  	ON R.CUSTOMER_ID = C.CUSTOMER_ID  
  	JOIN ROOMS RO  
  	ON RO.ROOM_ID = R.ROOM_ID  
  	JOIN HOTELS H   
  	ON RO.HOTEL_ID = H.HOTEL_ID  
  	WHERE H.HOTEL_ID = 1; 
    
-- Q.17 CALCULATE TOTAL REVENUE PER HOTEL.   
  	SELECT H.HOTEL_NAME, sum(P.AMOUNT) AS TOTAL_REVENUE  
  	FROM PAYMENTS P   
  	JOIN RESERVATION R   
  	ON P.RESERVATION_ID = R.RESERVATION_ID  
  	JOIN ROOMS RO  
  	ON RO.ROOM_ID = R.ROOM_ID  
 JOIN HOTELS H   
  	ON RO.HOTEL_ID = H.HOTEL_ID  
  	GROUP BY H.HOTEL_NAME  ORDER BY TOTAL_REVENUE;  
    
-- Q.18 FIND CUSTOMER FROM MULTIPLE RESERVATIONS.   
  	SELECT C.FULL_NAME, COUNT(R.RESERVATION_ID)AS TOTAL_RESERVATIONS  
  	FROM CUSTOMERS C   
  	JOIN RESERVATION R   
  	ON C.CUSTOMER_ID = R.CUSTOMER_ID  
  	GROUP BY C.CUSTOMER_ID  
 HAVING COUNT(R.RESERVATION_ID);
 
 -- Q.19 LIST CUSTOMERS WHO PAID MORE THAN THE AVERAGE PAYMENT
SELECT C.CUSTOMER_ID,C.FULL_NAME,P.AMOUNT FROM PAYMENTS P 
JOIN RESERVATION R  
ON P.RESERVATION_ID = R.RESERVATION_ID 
JOIN CUSTOMERS C  
ON C.CUSTOMER_ID = R.CUSTOMER_ID 
WHERE P.AMOUNT > (SELECT AVG(P.AMOUNT) FROM PAYMENTS P); 

-- Q.20  GET STAFF WHO WORK IN HOTELS WITH HIGHEST RATING. 
SELECT S.STAFF_ID,S.FULL_NAME,H.HOTEL_NAME,H.RATING 
FROM STAFF S 
JOIN HOTELS H ON S.HOTEL_ID = H.HOTEL_ID 
WHERE H.RATING = (SELECT MAX(H.RATING) FROM HOTELS H); 


 

  
  

  
